<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : Caesar
Description : An implementation of the Caesar cipher
Copyright   : (c) Roland Tritsch, 2017
License     : GPL-3
Maintainer  : roland@tritsch.org
Stability   : experimental
Portability : POSIX

This is an implementation of the [Caesar cipher](https://en.wikipedia.org/wiki/Caesar_cipher).
-}</span><span>
</span><a name="line-12"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Caesar</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-13"></a><span>  </span><a href="Caesar.html#encrypt"><span class="hs-identifier hs-var">encrypt</span></a><span class="hs-special">,</span><span>
</span><a name="line-14"></a><span>  </span><a href="Caesar.html#decrypt"><span class="hs-identifier hs-var">decrypt</span></a><span class="hs-special">,</span><span>
</span><a name="line-15"></a><span>  </span><a href="Caesar.html#alphabet"><span class="hs-identifier hs-var">alphabet</span></a><span>
</span><a name="line-16"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span class="hs-comment">-- |The alphabet (means all of the chars) we support for encryption.</span><span>
</span><a name="line-22"></a><span class="hs-comment">-- |TODO: Use type Alphabet as the type (instead of String).</span><span>
</span><a name="line-23"></a><span class="hs-identifier">alphabet</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-24"></a><a name="alphabet"><a href="Caesar.html#alphabet"><span class="hs-identifier">alphabet</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-25"></a><span>  </span><span class="hs-special">[</span><span class="hs-char">'a'</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-char">'z'</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-26"></a><span>  </span><span class="hs-special">[</span><span class="hs-char">'A'</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-char">'Z'</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-27"></a><span>  </span><span class="hs-special">[</span><span class="hs-char">'0'</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-char">'9'</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-28"></a><span>  </span><span class="hs-string">&quot;!@#$%^&amp;*()_+-={}|[]:;&lt;&gt;?,./~`\\\&quot;\' &quot;</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span class="hs-comment">-- |To lookup a character by its position in an alphabet.</span><span>
</span><a name="line-31"></a><span class="hs-comment">-- |Note: The lookup uses a lazily evaluatated endless concatuation of alphabets to support arbitrarily large keys (i.e. keys that are larger than the alphabet). So that we do not have to mess around with modolo operations.</span><span>
</span><a name="line-32"></a><span class="hs-identifier">lookup'</span><span>
</span><a name="line-33"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^The position to lookup in the alphabet. p can be a bigger than the size of the alphabet.</span><span>
</span><a name="line-34"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-comment">-- ^Return the character at poistion p.</span><span>
</span><a name="line-35"></a><a name="lookup%27"><a href="Caesar.html#lookup%27"><span class="hs-identifier">lookup'</span></a></a><span> </span><a name="local-6989586621679019373"><a href="#local-6989586621679019373"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679019374"><span class="hs-identifier hs-var">a'</span></a><span> </span><span class="hs-operator hs-var">!!</span><span> </span><a href="#local-6989586621679019373"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-36"></a><span>  </span><a name="local-6989586621679019374"><a href="#local-6989586621679019374"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679019375"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="Caesar.html#alphabet"><span class="hs-identifier hs-var">alphabet</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-37"></a><span>    </span><a name="local-6989586621679019375"><a href="#local-6989586621679019375"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679019376"><a href="#local-6989586621679019376"><span class="hs-identifier">a''</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679019376"><span class="hs-identifier hs-var">a''</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679019375"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679019376"><span class="hs-identifier hs-var">a''</span></a><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-comment">-- |To lookup a character by its position in a reversed alphabet.</span><span>
</span><a name="line-40"></a><span class="hs-comment">-- |Note: This is used for decryption. Instead of going backwards in the alphabet it is easier to go forward in a reversed alphabet.</span><span>
</span><a name="line-41"></a><span class="hs-identifier">lookupr'</span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Char</span><span>
</span><a name="line-42"></a><a name="lookupr%27"><a href="Caesar.html#lookupr%27"><span class="hs-identifier">lookupr'</span></a></a><span> </span><a name="local-6989586621679019572"><a href="#local-6989586621679019572"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679019573"><span class="hs-identifier hs-var">a'</span></a><span> </span><span class="hs-operator hs-var">!!</span><span> </span><a href="#local-6989586621679019572"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-43"></a><span>  </span><a name="local-6989586621679019573"><a href="#local-6989586621679019573"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679019574"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="Caesar.html#alphabet"><span class="hs-identifier hs-var">alphabet</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-44"></a><span>    </span><a name="local-6989586621679019574"><a href="#local-6989586621679019574"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679019575"><a href="#local-6989586621679019575"><span class="hs-identifier">a''</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679019575"><span class="hs-identifier hs-var">a''</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679019574"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679019575"><span class="hs-identifier hs-var">a''</span></a><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-comment">-- |Find all positions of a given text in a given alphabet (e.g. &quot;abc&quot; -&gt; [0, 1, 2])</span><span>
</span><a name="line-47"></a><span class="hs-identifier">findPositions</span><span>
</span><a name="line-48"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^The text to find the positions of.</span><span>
</span><a name="line-49"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^The alphabet to lookup the positions in.</span><span>
</span><a name="line-50"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^Return the list of positions.</span><span>
</span><a name="line-51"></a><a name="findPositions"><a href="Caesar.html#findPositions"><span class="hs-identifier">findPositions</span></a></a><span> </span><a name="local-6989586621679019576"><a href="#local-6989586621679019576"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679019577"><a href="#local-6989586621679019577"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapMaybe</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679019578"><a href="#local-6989586621679019578"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">findIndex</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679019712"><a href="#local-6989586621679019712"><span class="hs-identifier">c'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679019712"><span class="hs-identifier hs-var">c'</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679019578"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679019577"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679019576"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-comment">-- |Calculate the new positions from the old positions and the given key.</span><span>
</span><a name="line-54"></a><span class="hs-identifier">calcPositions</span><span>
</span><a name="line-55"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^The key to use to calculate the new positions.</span><span>
</span><a name="line-56"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^The old positions.</span><span>
</span><a name="line-57"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^Return the new (encrypted or decrypted) positions.</span><span>
</span><a name="line-58"></a><a name="calcPositions"><a href="Caesar.html#calcPositions"><span class="hs-identifier">calcPositions</span></a></a><span> </span><a name="local-6989586621679023279"><a href="#local-6989586621679023279"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679023280"><a href="#local-6989586621679023280"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679023281"><a href="#local-6989586621679023281"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679023281"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679023279"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679023280"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-comment">-- |Lookup the chars in the new position.</span><span>
</span><a name="line-61"></a><span class="hs-identifier">codePositions</span><span>
</span><a name="line-62"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Char</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^The lookup function (luf) to use to lookup the chars (lookup' for encryption or lookupr' for decryption).</span><span>
</span><a name="line-63"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^The list of positions to lookup.</span><span>
</span><a name="line-64"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^Return the resulting list of chars/string.</span><span>
</span><a name="line-65"></a><a name="codePositions"><a href="Caesar.html#codePositions"><span class="hs-identifier">codePositions</span></a></a><span> </span><a name="local-6989586621679023346"><a href="#local-6989586621679023346"><span class="hs-identifier">luf</span></a></a><span> </span><a name="local-6989586621679023347"><a href="#local-6989586621679023347"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679023348"><a href="#local-6989586621679023348"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679023346"><span class="hs-identifier hs-var">luf</span></a><span> </span><a href="#local-6989586621679023348"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679023347"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-comment">-- |Encrypt a given text with a given key.</span><span>
</span><a name="line-68"></a><span class="hs-identifier">encrypt</span><span>
</span><a name="line-69"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^The text to encrypt. Note: We check that all chars in the text are in the alphabet. Otherwise we abort the encryption. TODO: Use PlainText as the type.</span><span>
</span><a name="line-70"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^The key to use to encrypt the text. Can be any Int. Pos and Neg. We take the abs of it, before we pass it on.</span><span>
</span><a name="line-71"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^Return the encrypted text. TODO: Use EncryptedText as the type.</span><span>
</span><a name="line-72"></a><a name="encrypt"><a href="Caesar.html#encrypt"><span class="hs-identifier">encrypt</span></a></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-73"></a><span class="hs-identifier">encrypt</span><span> </span><a name="local-6989586621679023349"><a href="#local-6989586621679023349"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679023350"><a href="#local-6989586621679023350"><span class="hs-identifier">k</span></a></a><span>
</span><a name="line-74"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679024427"><a href="#local-6989586621679024427"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">elem</span><span> </span><a href="#local-6989586621679024427"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="Caesar.html#alphabet"><span class="hs-identifier hs-var">alphabet</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679023349"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Caesar.html#encrypt%27"><span class="hs-identifier hs-var">encrypt'</span></a><span> </span><a href="#local-6989586621679023349"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-6989586621679023350"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="Caesar.html#alphabet"><span class="hs-identifier hs-var">alphabet</span></a><span>
</span><a name="line-75"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Unknown char in text. Cannot encrypt.&quot;</span><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-comment">-- |Encrypt a given text with a given key using the alphabet.</span><span>
</span><a name="line-78"></a><span class="hs-identifier">encrypt'</span><span>
</span><a name="line-79"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^The text to encrypt.</span><span>
</span><a name="line-80"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^The key to use.</span><span>
</span><a name="line-81"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^The alphabet to use.</span><span>
</span><a name="line-82"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^Return the encrypted text.</span><span>
</span><a name="line-83"></a><a name="encrypt%27"><a href="Caesar.html#encrypt%27"><span class="hs-identifier">encrypt'</span></a></a><span> </span><a name="local-6989586621679024428"><a href="#local-6989586621679024428"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679024429"><a href="#local-6989586621679024429"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679024430"><a href="#local-6989586621679024430"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-84"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679024431"><a href="#local-6989586621679024431"><span class="hs-identifier">positions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Caesar.html#findPositions"><span class="hs-identifier hs-var">findPositions</span></a><span> </span><a href="#local-6989586621679024428"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679024430"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-85"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679024432"><a href="#local-6989586621679024432"><span class="hs-identifier">encryptedPositions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Caesar.html#calcPositions"><span class="hs-identifier hs-var">calcPositions</span></a><span> </span><a href="#local-6989586621679024429"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679024431"><span class="hs-identifier hs-var">positions</span></a><span>
</span><a name="line-86"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679024433"><a href="#local-6989586621679024433"><span class="hs-identifier">encrypted</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Caesar.html#codePositions"><span class="hs-identifier hs-var">codePositions</span></a><span> </span><a href="Caesar.html#lookup%27"><span class="hs-identifier hs-var">lookup'</span></a><span> </span><a href="#local-6989586621679024432"><span class="hs-identifier hs-var">encryptedPositions</span></a><span>
</span><a name="line-87"></a><span>  </span><a href="#local-6989586621679024433"><span class="hs-identifier hs-var">encrypted</span></a><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span class="hs-comment">-- |Decrypt a given text with a given key.</span><span>
</span><a name="line-90"></a><span class="hs-identifier">decrypt</span><span>
</span><a name="line-91"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^The text to encrypt.</span><span>
</span><a name="line-92"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^The key to use.</span><span>
</span><a name="line-93"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^Return the encrypted text.</span><span>
</span><a name="line-94"></a><a name="decrypt"><a href="Caesar.html#decrypt"><span class="hs-identifier">decrypt</span></a></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-95"></a><span class="hs-identifier">decrypt</span><span> </span><a name="local-6989586621679024434"><a href="#local-6989586621679024434"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679024435"><a href="#local-6989586621679024435"><span class="hs-identifier">k</span></a></a><span>
</span><a name="line-96"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679024436"><a href="#local-6989586621679024436"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">elem</span><span> </span><a href="#local-6989586621679024436"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="Caesar.html#alphabet"><span class="hs-identifier hs-var">alphabet</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679024434"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Caesar.html#decrypt%27"><span class="hs-identifier hs-var">decrypt'</span></a><span> </span><a href="#local-6989586621679024434"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-6989586621679024435"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="Caesar.html#alphabet"><span class="hs-identifier hs-var">alphabet</span></a><span>
</span><a name="line-97"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Unknown char in text. Cannot decrypt.&quot;</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-comment">-- |Decrypt a given text with a given key using the alphabet.</span><span>
</span><a name="line-100"></a><span class="hs-comment">-- |Note: Decryption is implemented by moving forward on a reversed alphabet. That saves a lot of arkward modolo calculations.</span><span>
</span><a name="line-101"></a><span class="hs-identifier">decrypt'</span><span>
</span><a name="line-102"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^The text to decrypt.</span><span>
</span><a name="line-103"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^The key to use.</span><span>
</span><a name="line-104"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^The alphabet to use.</span><span>
</span><a name="line-105"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^Return the decrypted text.</span><span>
</span><a name="line-106"></a><a name="decrypt%27"><a href="Caesar.html#decrypt%27"><span class="hs-identifier">decrypt'</span></a></a><span> </span><a name="local-6989586621679024437"><a href="#local-6989586621679024437"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679024438"><a href="#local-6989586621679024438"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679024439"><a href="#local-6989586621679024439"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-107"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679024440"><a href="#local-6989586621679024440"><span class="hs-identifier">positions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Caesar.html#findPositions"><span class="hs-identifier hs-var">findPositions</span></a><span> </span><a href="#local-6989586621679024437"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679024439"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-108"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679024441"><a href="#local-6989586621679024441"><span class="hs-identifier">decryptedPositions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Caesar.html#calcPositions"><span class="hs-identifier hs-var">calcPositions</span></a><span> </span><a href="#local-6989586621679024438"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679024440"><span class="hs-identifier hs-var">positions</span></a><span>
</span><a name="line-109"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679024442"><a href="#local-6989586621679024442"><span class="hs-identifier">decrypted</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Caesar.html#codePositions"><span class="hs-identifier hs-var">codePositions</span></a><span> </span><a href="Caesar.html#lookupr%27"><span class="hs-identifier hs-var">lookupr'</span></a><span> </span><a href="#local-6989586621679024441"><span class="hs-identifier hs-var">decryptedPositions</span></a><span>
</span><a name="line-110"></a><span>  </span><a href="#local-6989586621679024442"><span class="hs-identifier hs-var">decrypted</span></a><span>
</span><a name="line-111"></a></pre></body></html>